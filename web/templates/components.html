<!-- Reusable Form Components for HTMX -->

<!-- Text Input Field -->
<template id="text-input">
    <div class="field mb-4">
        <label class="block text-sm font-medium text-slate-300 mb-2">
            <span class="field-label"></span>
            <span class="required text-red-500"></span>
        </label>
        <input 
            type="text" 
            class="w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-slate-100 focus:outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-400 transition-colors field-input"
            data-field=""
            data-required="false"
            @change="markDirty()"
        />
        <p class="field-error text-red-400 text-xs mt-1 hidden"></p>
    </div>
</template>

<!-- Number Input Field -->
<template id="number-input">
    <div class="field mb-4">
        <label class="block text-sm font-medium text-slate-300 mb-2">
            <span class="field-label"></span>
            <span class="required text-red-500"></span>
        </label>
        <input 
            type="number" 
            class="w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-slate-100 focus:outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-400 transition-colors field-input"
            data-field=""
            data-required="false"
            @change="markDirty()"
        />
        <p class="field-error text-red-400 text-xs mt-1 hidden"></p>
    </div>
</template>

<!-- Boolean Toggle Field -->
<template id="boolean-input">
    <div class="field mb-4">
        <label class="flex items-center gap-3">
            <input 
                type="checkbox" 
                class="w-4 h-4 rounded bg-slate-800 border-slate-600 text-blue-500 focus:ring-blue-400 cursor-pointer field-input"
                data-field=""
                data-required="false"
                @change="markDirty()"
            />
            <span class="text-sm font-medium text-slate-300 field-label"></span>
        </label>
    </div>
</template>

<!-- Autocomplete Select Field (with dropdown from API) -->
<template id="autocomplete-select">
    <div class="field mb-4">
        <label class="block text-sm font-medium text-slate-300 mb-2">
            <span class="field-label"></span>
            <span class="required text-red-500"></span>
        </label>
        <div class="relative">
            <input 
                type="text" 
                class="w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-slate-100 focus:outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-400 transition-colors field-input autocomplete-input"
                data-field=""
                data-data-type=""
                data-required="false"
                autocomplete="off"
                @input="filterAutocomplete(event)"
                @focus="showAutocomplete(event)"
                @blur="setTimeout(() => hideAutocomplete(event), 100)"
            />
            <div class="absolute top-full left-0 right-0 mt-1 bg-slate-800 border border-slate-600 rounded-lg shadow-lg hidden autocomplete-dropdown max-h-48 overflow-y-auto z-10">
                <!-- Options will be populated via JavaScript -->
            </div>
        </div>
        <p class="field-error text-red-400 text-xs mt-1 hidden"></p>
    </div>
</template>

<!-- String Array Field -->
<template id="string-array">
    <div class="field mb-4">
        <label class="block text-sm font-medium text-slate-300 mb-2">
            <span class="field-label"></span>
        </label>
        <div class="space-y-2 array-container">
            <!-- Array items will be added here -->
        </div>
        <button 
            type="button"
            class="mt-2 px-3 py-1 bg-slate-700 hover:bg-slate-600 rounded text-sm transition-colors add-array-item"
            @click="addArrayItem(event)"
        >
            + Add Item
        </button>
    </div>
</template>

<!-- Array Item (for string arrays) -->
<template id="array-item">
    <div class="flex gap-2 array-item">
        <input 
            type="text" 
            class="flex-1 px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-slate-100 focus:outline-none focus:border-blue-400 text-sm"
            @change="markDirty()"
        />
        <button 
            type="button"
            class="px-2 py-2 bg-red-900/30 hover:bg-red-900/50 rounded text-red-400 text-sm transition-colors"
            @click="removeArrayItem(event)"
        >
            ✕
        </button>
    </div>
</template>

<!-- Collapsible Section -->
<template id="collapsible-section">
    <div class="section mb-6 border border-slate-700 rounded-lg overflow-hidden">
        <button 
            type="button"
            class="w-full px-6 py-4 bg-gradient-to-r from-slate-800 to-slate-700 hover:from-slate-700 hover:to-slate-600 flex items-center justify-between font-semibold text-slate-200 transition-colors section-toggle"
            @click="toggleSection(event)"
        >
            <div class="flex items-center gap-3">
                <span class="section-title"></span>
                <span class="section-badge text-xs px-2 py-1 rounded-full bg-slate-700"></span>
            </div>
            <span class="section-chevron">▼</span>
        </button>
        <div class="section-content bg-slate-900/50 px-6 py-4 hidden">
            <!-- Content will be added here -->
        </div>
    </div>
</template>

<!-- Validation Error Display -->
<template id="error-message">
    <div class="p-4 mb-4 bg-red-900/20 border border-red-700 rounded-lg flex gap-3">
        <span class="text-red-400 font-bold">⚠</span>
        <div>
            <p class="font-medium text-red-300 error-field"></p>
            <p class="text-red-400 text-sm error-message"></p>
        </div>
    </div>
</template>

<!-- Success Toast -->
<template id="success-toast">
    <div class="bg-green-900/80 border border-green-700 text-green-200 px-4 py-3 rounded-lg flex items-center gap-2">
        <span>✓</span>
        <span class="toast-message"></span>
    </div>
</template>

<!-- Loading State -->
<template id="loading-spinner">
    <div class="flex items-center justify-center gap-2 text-slate-400">
        <div class="animate-spin">⏳</div>
        <span class="loading-text">Loading...</span>
    </div>
</template>
